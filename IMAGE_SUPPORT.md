# 图片剪贴板支持

## 新增功能

Pushpin 现在支持历史剪贴板图片！

### 主要特性

1. **自动检测图片**
   - 当你复制图片时，Pushpin 会自动检测并保存到历史记录中
   - 图片以 PNG 格式存储，确保高质量

2. **图片预览**
   - 在历史记录列表中显示 80x80 像素的缩略图
   - 图片项使用 📷 图标标识
   - 文本项继续使用 📄 图标标识

3. **搜索支持**
   - 可以通过输入 "image" 来筛选所有图片项
   - 文本项继续支持全文搜索

4. **一键粘贴**
   - 点击图片项会自动将图片复制到剪贴板
   - 然后模拟 Cmd+V 粘贴到当前应用

5. **持久化存储**
   - 图片数据保存在 UserDefaults 中
   - 应用重启后历史记录依然保留

## 使用方法

1. **复制图片**
   - 在任何应用中复制图片（Cmd+C）
   - Pushpin 会自动检测并添加到历史记录

2. **查看历史**
   - 点击状态栏图标或使用快捷键打开 Pushpin
   - 图片会显示为缩略图预览

3. **粘贴图片**
   - 点击任意图片项
   - 图片会自动粘贴到当前应用

4. **搜索图片**
   - 在搜索框输入 "image" 查看所有图片
   - 或输入其他关键词搜索文本项

## 配置选项

### 最大历史记录数量

在设置页面可以配置最大历史记录数量：

1. 点击工具栏的 ⚙️ 设置按钮
2. 找到 "Max History" 选项
3. 使用步进器调整数量（10-200 项，步长 10）
4. 默认值为 50 项

**自动清理机制：**
- 当历史记录超过设置的最大数量时，会自动删除最旧的记录
- 如果降低最大数量设置，会立即删除超出部分的旧记录
- 清理同时适用于文本和图片项

## 技术实现

### 数据模型
- `ClipboardItemType`: 枚举类型，支持 `.text` 和 `.image`
- `ClipboardItem`: 扩展支持 `imageData` 字段存储 PNG 数据
- 提供便捷初始化方法 `init(text:date:)` 和 `init(image:date:)`

### 检测逻辑
- 优先检测图片类型（NSImage）
- 如果没有图片，再检测文本类型
- 避免重复添加相同内容

### 自动清理
- 每次添加新项时检查数量限制
- 使用 `removeSubrange()` 批量删除超出的项
- 最大数量存储在 UserDefaults 中，可持久化

### 显示优化
- 使用 SwiftUI 的 `Image(nsImage:)` 显示图片
- 图片使用 `aspectRatio(contentMode: .fill)` 保持比例
- 添加圆角和边框提升视觉效果

## 限制

- 历史记录数量可配置（10-200 项）
- 图片以 PNG 格式存储，可能占用较多空间
- 非常大的图片可能影响性能
- 所有数据存储在 UserDefaults 中

## 后续改进建议

1. 添加图片尺寸显示
2. 支持图片格式转换
3. 添加图片压缩选项
4. 支持图片编辑功能
5. 添加图片导出功能
6. 添加基于存储大小的限制
7. 支持单条删除功能
